<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FastqPuri: src/bloom.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FastqPuri
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">bloom.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>functions that implement the bloom filter  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="bloom_8h_source.html">bloom.h</a>&quot;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for bloom.c:</div>
<div class="dyncontent">
<div class="center"><img src="bloom_8c__incl.png" border="0" usemap="#src_2bloom_8c" alt=""/></div>
<map name="src_2bloom_8c" id="src_2bloom_8c">
<area shape="rect" id="node2" href="bloom_8h.html" title="functions that implement the bloom filter " alt="" coords="97,80,171,107"/>
<area shape="rect" id="node3" href="city_8h.html" title="functions for hashin strings, C translation of cityhash (C++, google) " alt="" coords="13,155,69,181"/>
<area shape="rect" id="node6" href="fa__read_8h.html" title="reads in and stores fasta files " alt="" coords="93,155,175,181"/>
<area shape="rect" id="node7" href="defines_8h.html" title="Macro definitions. " alt="" coords="200,155,281,181"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0cc73db1215bac578f7d6e8df02d9768"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#a0cc73db1215bac578f7d6e8df02d9768">init_LUTs</a> ()</td></tr>
<tr class="memdesc:a0cc73db1215bac578f7d6e8df02d9768"><td class="mdescLeft">&#160;</td><td class="mdescRight">look up table initialization  <a href="#a0cc73db1215bac578f7d6e8df02d9768">More...</a><br /></td></tr>
<tr class="separator:a0cc73db1215bac578f7d6e8df02d9768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e5f24cae575f929614ff14daedab9ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#a5e5f24cae575f929614ff14daedab9ac">init_Bfilter</a> (int kmersize, uint64_t bfsizeBits, int hashNum, double falsePosRate, uint64_t nelem)</td></tr>
<tr class="memdesc:a5e5f24cae575f929614ff14daedab9ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialization of a Bfilter structure  <a href="#a5e5f24cae575f929614ff14daedab9ac">More...</a><br /></td></tr>
<tr class="separator:a5e5f24cae575f929614ff14daedab9ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cd02061aef113067b7cb701b399f502"><td class="memItemLeft" align="right" valign="top"><a id="a2cd02061aef113067b7cb701b399f502"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#a2cd02061aef113067b7cb701b399f502">free_Bfilter</a> (<a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *ptr_bf)</td></tr>
<tr class="memdesc:a2cd02061aef113067b7cb701b399f502"><td class="mdescLeft">&#160;</td><td class="mdescRight">free Bfilter memory <br /></td></tr>
<tr class="separator:a2cd02061aef113067b7cb701b399f502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a880cf4acfc80f5a7520b13ef5e06771e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bloom_8h.html#a4bf3f34a321ce545e533d29ce363f569">Bfkmer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#a880cf4acfc80f5a7520b13ef5e06771e">init_Bfkmer</a> (int kmersize, int hashNum)</td></tr>
<tr class="memdesc:a880cf4acfc80f5a7520b13ef5e06771e"><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes a Bfkmer structure, given the kmersize and the number of hash functions  <a href="#a880cf4acfc80f5a7520b13ef5e06771e">More...</a><br /></td></tr>
<tr class="separator:a880cf4acfc80f5a7520b13ef5e06771e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2f9894d5e5efcc9d2cb1c0cbba4aef1"><td class="memItemLeft" align="right" valign="top"><a id="ac2f9894d5e5efcc9d2cb1c0cbba4aef1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#ac2f9894d5e5efcc9d2cb1c0cbba4aef1">free_Bfkmer</a> (<a class="el" href="bloom_8h.html#a4bf3f34a321ce545e533d29ce363f569">Bfkmer</a> *ptr_bfkmer)</td></tr>
<tr class="memdesc:ac2f9894d5e5efcc9d2cb1c0cbba4aef1"><td class="mdescLeft">&#160;</td><td class="mdescRight">free Bfkmer <br /></td></tr>
<tr class="separator:ac2f9894d5e5efcc9d2cb1c0cbba4aef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9def2eeca4fab1422ae398b15260398"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#ac9def2eeca4fab1422ae398b15260398">compact_kmer</a> (const unsigned char *sequence, uint64_t position, <a class="el" href="bloom_8h.html#a4bf3f34a321ce545e533d29ce363f569">Bfkmer</a> *ptr_bfkmer)</td></tr>
<tr class="memdesc:ac9def2eeca4fab1422ae398b15260398"><td class="mdescLeft">&#160;</td><td class="mdescRight">compactifies a kmer for insertion in the bloomfilter  <a href="#ac9def2eeca4fab1422ae398b15260398">More...</a><br /></td></tr>
<tr class="separator:ac9def2eeca4fab1422ae398b15260398"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f4db9f997a1201561fea5f01df997a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#a4f4db9f997a1201561fea5f01df997a8">multiHash</a> (<a class="el" href="bloom_8h.html#a4bf3f34a321ce545e533d29ce363f569">Bfkmer</a> *ptr_bfkmer)</td></tr>
<tr class="memdesc:a4f4db9f997a1201561fea5f01df997a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">obtains the hashNum hashvalues for a compactified kmer  <a href="#a4f4db9f997a1201561fea5f01df997a8">More...</a><br /></td></tr>
<tr class="separator:a4f4db9f997a1201561fea5f01df997a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80545f536f97a769a0c10cb437a83695"><td class="memItemLeft" align="right" valign="top"><a class="el" href="defines_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#a80545f536f97a769a0c10cb437a83695">insert_and_fetch</a> (<a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *ptr_bf, <a class="el" href="bloom_8h.html#a4bf3f34a321ce545e533d29ce363f569">Bfkmer</a> *ptr_bfkmer)</td></tr>
<tr class="memdesc:a80545f536f97a769a0c10cb437a83695"><td class="mdescLeft">&#160;</td><td class="mdescRight">inserts the hashvalues of a kmer in filter  <a href="#a80545f536f97a769a0c10cb437a83695">More...</a><br /></td></tr>
<tr class="separator:a80545f536f97a769a0c10cb437a83695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab19bebeff1057ce39ef079d013421bb7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="defines_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#ab19bebeff1057ce39ef079d013421bb7">contains</a> (<a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *ptr_bf, <a class="el" href="bloom_8h.html#a4bf3f34a321ce545e533d29ce363f569">Bfkmer</a> *ptr_bfkmer)</td></tr>
<tr class="memdesc:ab19bebeff1057ce39ef079d013421bb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if kmer is contained in the filter  <a href="#ab19bebeff1057ce39ef079d013421bb7">More...</a><br /></td></tr>
<tr class="separator:ab19bebeff1057ce39ef079d013421bb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6e5788b92c0547d77425847d413851f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#ad6e5788b92c0547d77425847d413851f">create_Bfilter</a> (<a class="el" href="fa__read_8h.html#a797328b16bc1c1088998cd164aafb09d">Fa_data</a> *ptr_fasta, int kmersize, uint64_t bfsizeBits, int hashNum, double falsePosRate, uint64_t nelem)</td></tr>
<tr class="memdesc:ad6e5788b92c0547d77425847d413851f"><td class="mdescLeft">&#160;</td><td class="mdescRight">creates a bloom filter from a fasta structure.  <a href="#ad6e5788b92c0547d77425847d413851f">More...</a><br /></td></tr>
<tr class="separator:ad6e5788b92c0547d77425847d413851f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48a74d10082ed27381512e23650ba823"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#a48a74d10082ed27381512e23650ba823">save_Bfilter</a> (<a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *ptr_bf, char *filterfile, char *paramfile)</td></tr>
<tr class="memdesc:a48a74d10082ed27381512e23650ba823"><td class="mdescLeft">&#160;</td><td class="mdescRight">saves a bloomfilter to disk  <a href="#a48a74d10082ed27381512e23650ba823">More...</a><br /></td></tr>
<tr class="separator:a48a74d10082ed27381512e23650ba823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2418c40c2ff7a69a84aeb4ddde266e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#af2418c40c2ff7a69a84aeb4ddde266e0">read_Bfilter</a> (char *filterfile, char *paramfile)</td></tr>
<tr class="memdesc:af2418c40c2ff7a69a84aeb4ddde266e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">reads a bloom filter from a file  <a href="#af2418c40c2ff7a69a84aeb4ddde266e0">More...</a><br /></td></tr>
<tr class="separator:af2418c40c2ff7a69a84aeb4ddde266e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5b3e90499bde8b37f73fbf4bf414674e"><td class="memItemLeft" align="right" valign="top"><a id="a5b3e90499bde8b37f73fbf4bf414674e"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#a5b3e90499bde8b37f73fbf4bf414674e">fw0</a> [256]</td></tr>
<tr class="memdesc:a5b3e90499bde8b37f73fbf4bf414674e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global variables (lookup table) Used to compactify kmers. <br /></td></tr>
<tr class="separator:a5b3e90499bde8b37f73fbf4bf414674e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cd6d513d72b2cbf6bbae9a216d34e61"><td class="memItemLeft" align="right" valign="top"><a id="a2cd6d513d72b2cbf6bbae9a216d34e61"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>fw1</b> [256]</td></tr>
<tr class="separator:a2cd6d513d72b2cbf6bbae9a216d34e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab73df67c76c20f0f591b5a5f4e0cc4e6"><td class="memItemLeft" align="right" valign="top"><a id="ab73df67c76c20f0f591b5a5f4e0cc4e6"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>fw2</b> [256]</td></tr>
<tr class="separator:ab73df67c76c20f0f591b5a5f4e0cc4e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec0e309c68f897e5df33c91ab0c77533"><td class="memItemLeft" align="right" valign="top"><a id="aec0e309c68f897e5df33c91ab0c77533"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>fw3</b> [256]</td></tr>
<tr class="separator:aec0e309c68f897e5df33c91ab0c77533"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f84a9e9709b160cecdf8075ec9904bc"><td class="memItemLeft" align="right" valign="top"><a id="a5f84a9e9709b160cecdf8075ec9904bc"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>bw0</b> [256]</td></tr>
<tr class="separator:a5f84a9e9709b160cecdf8075ec9904bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e3a8db162b65dec868dc9d7258b4ef4"><td class="memItemLeft" align="right" valign="top"><a id="a2e3a8db162b65dec868dc9d7258b4ef4"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>bw1</b> [256]</td></tr>
<tr class="separator:a2e3a8db162b65dec868dc9d7258b4ef4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a4700b5cd90c1fb97050623b84d3ce"><td class="memItemLeft" align="right" valign="top"><a id="aa1a4700b5cd90c1fb97050623b84d3ce"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>bw2</b> [256]</td></tr>
<tr class="separator:aa1a4700b5cd90c1fb97050623b84d3ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade667321e4ebea595e0bd22d2afdb00e"><td class="memItemLeft" align="right" valign="top"><a id="ade667321e4ebea595e0bd22d2afdb00e"></a>
static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>bw3</b> [256]</td></tr>
<tr class="separator:ade667321e4ebea595e0bd22d2afdb00e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae59851bb0bb0e2d66b28d475a0eca5a0"><td class="memItemLeft" align="right" valign="top">static const unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#ae59851bb0bb0e2d66b28d475a0eca5a0">bitMask</a> [0x08]</td></tr>
<tr class="memdesc:ae59851bb0bb0e2d66b28d475a0eca5a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">bitMask, ith bit set to 1 in position i  <a href="#ae59851bb0bb0e2d66b28d475a0eca5a0">More...</a><br /></td></tr>
<tr class="separator:ae59851bb0bb0e2d66b28d475a0eca5a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f18264718e0b1b1be5a1f0ee64431e4"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8c.html#a1f18264718e0b1b1be5a1f0ee64431e4">alloc_mem</a></td></tr>
<tr class="separator:a1f18264718e0b1b1be5a1f0ee64431e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>functions that implement the bloom filter </p>
<dl class="section author"><dt>Author</dt><dd>Paula Perez <a href="#" onclick="location.href='mai'+'lto:'+'pau'+'la'+'per'+'ez'+'rub'+'io'+'@gm'+'ai'+'l.c'+'om'; return false;">paula<span style="display: none;">.nosp@m.</span>pere<span style="display: none;">.nosp@m.</span>zrubi<span style="display: none;">.nosp@m.</span>o@gm<span style="display: none;">.nosp@m.</span>ail.c<span style="display: none;">.nosp@m.</span>om</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>04.09.2017 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac9def2eeca4fab1422ae398b15260398"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9def2eeca4fab1422ae398b15260398">&#9670;&nbsp;</a></span>compact_kmer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int compact_kmer </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>sequence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bloom_8h.html#a4bf3f34a321ce545e533d29ce363f569">Bfkmer</a> *&#160;</td>
          <td class="paramname"><em>ptr_bfkmer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compactifies a kmer for insertion in the bloomfilter </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sequence</td><td>unsigned char DNA sequence (or cDNA) </td></tr>
    <tr><td class="paramname">position</td><td>position in the sequence where the kmer starts </td></tr>
    <tr><td class="paramname">ptr_bfkmer</td><td>initialized Bfkmer</td></tr>
  </table>
  </dd>
</dl>
<p>The compactified sequence is computed in the following way:</p><ul>
<li>We start compactifying both, the forward and backward (reverse complement). The outer loop covers up until half of the sequence.</li>
<li>As soon as one of the two is lexicographically smaller, we continue only with it. In that way, the "smaller" sequence is consistently returned.</li>
<li>If the sequence is palindromic, we continue with the forward sequence.</li>
<li><p class="startli">kmersize should be &gt; 3.</p>
<p class="startli">We illustrate the compactification with an example: </p><div class="fragment"><div class="line">kmer = TTTT|GGAT</div><div class="line">m_fw = 00000000 | 00000000 <span class="comment">// 2 bytes</span></div><div class="line">m_bw = 00000000 | 00000000 <span class="comment">// 2 bytes</span></div><div class="line">m_fw[0] |= <a class="code" href="bloom_8c.html#a5b3e90499bde8b37f73fbf4bf414674e">fw0</a>[<span class="charliteral">&#39;T&#39;</span>] = 0xC0|0x00;    m_bw[0] |= bw0[<span class="charliteral">&#39;T&#39;</span>] = 0x00|0x00;</div><div class="line">m_fw[0] |= fw1[<span class="charliteral">&#39;T&#39;</span>] = 0xF0|0x00;    m_bw[0] |= bw1[<span class="charliteral">&#39;A&#39;</span>] = 0x30|0x00;</div><div class="line">m_fw[0] |= fw2[<span class="charliteral">&#39;T&#39;</span>] = 0xFC|0x00;    m_bw[0] |= bw2[<span class="charliteral">&#39;G&#39;</span>] = 0x34|0x00;</div><div class="line">m_fw[0] |= fw3[<span class="charliteral">&#39;T&#39;</span>] = 0xFF|0x00;    m_bw[0] |= bw3[<span class="charliteral">&#39;G&#39;</span>] = 0x35|0x00;</div><div class="line">m_fw[1] |= <a class="code" href="bloom_8c.html#a5b3e90499bde8b37f73fbf4bf414674e">fw0</a>[<span class="charliteral">&#39;G&#39;</span>] = 0xC0|0x80;    m_bw[1] |= bw0[<span class="charliteral">&#39;T&#39;</span>] = 0x35|0x00;</div><div class="line">m_fw[1] |= fw1[<span class="charliteral">&#39;G&#39;</span>] = 0xF0|0xA0;    m_bw[1] |= bw1[<span class="charliteral">&#39;T&#39;</span>] = 0x35|0x00;</div><div class="line">m_fw[1] |= fw2[<span class="charliteral">&#39;A&#39;</span>] = 0xFC|0xA0;    m_bw[1] |= bw2[<span class="charliteral">&#39;T&#39;</span>] = 0x35|0x00;</div><div class="line">m_fw[1] |= fw3[<span class="charliteral">&#39;T&#39;</span>] = 0xFF|0xA3;    m_bw[1] |= bw3[<span class="charliteral">&#39;T&#39;</span>] = 0x35|0x00;</div></div><!-- fragment --><p> (In this case, we would store m_bw) </p>
</li>
</ul>

</div>
</div>
<a id="ab19bebeff1057ce39ef079d013421bb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab19bebeff1057ce39ef079d013421bb7">&#9670;&nbsp;</a></span>contains()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="defines_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> contains </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *&#160;</td>
          <td class="paramname"><em>ptr_bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bloom_8h.html#a4bf3f34a321ce545e533d29ce363f569">Bfkmer</a> *&#160;</td>
          <td class="paramname"><em>ptr_bfkmer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check if kmer is contained in the filter </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr_bf</td><td>pointer to a Bfilter structure, where a bloomfilter is stored </td></tr>
    <tr><td class="paramname">ptr_bfkmer</td><td>pointer to a Bfkmer structure containing the hash values </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if all corresponding bits were set to 1 in the filter </dd></dl>

</div>
</div>
<a id="ad6e5788b92c0547d77425847d413851f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6e5788b92c0547d77425847d413851f">&#9670;&nbsp;</a></span>create_Bfilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a>* create_Bfilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fa__read_8h.html#a797328b16bc1c1088998cd164aafb09d">Fa_data</a> *&#160;</td>
          <td class="paramname"><em>ptr_fasta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kmersize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>bfsizeBits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hashNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>falsePosRate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>nelem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>creates a bloom filter from a fasta structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr_fasta</td><td>pointer to fasta structure </td></tr>
    <tr><td class="paramname">kmersize</td><td>length of kmers to be inserted in the filter </td></tr>
    <tr><td class="paramname">bfsizeBits</td><td>size of Bloom filter in bits </td></tr>
    <tr><td class="paramname">hashNum</td><td>number of hash functions to be used </td></tr>
    <tr><td class="paramname">falsePosRate</td><td>false positive rate </td></tr>
    <tr><td class="paramname">nelem</td><td>number of elemens (kmers in the sequece) contained in the filter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to Bloom filter structure, where the fasta file was encoded. </dd></dl>

</div>
</div>
<a id="a5e5f24cae575f929614ff14daedab9ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e5f24cae575f929614ff14daedab9ac">&#9670;&nbsp;</a></span>init_Bfilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a>* init_Bfilter </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kmersize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>bfsizeBits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hashNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>falsePosRate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>nelem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialization of a Bfilter structure </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kmersize</td><td>number of elements of the kmer </td></tr>
    <tr><td class="paramname">bfsizeBits</td><td>size of the bloomfilter (in Bits) </td></tr>
    <tr><td class="paramname">hashNum</td><td>number of hash functions to be computed </td></tr>
    <tr><td class="paramname">falsePosRate</td><td>false positive rate </td></tr>
    <tr><td class="paramname">nelem</td><td>number of elemens (kmers in the sequece) contained in the filter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to initialized Bfilter structure</dd></dl>
<p>Given a kmersize, bfsizeBits, number of hash functions, we assign these values to the struture and the two additional values: kmersizeBytes = (kmersize + BASESINCHAR - 1 )/BASESINCHAR </p>

</div>
</div>
<a id="a880cf4acfc80f5a7520b13ef5e06771e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a880cf4acfc80f5a7520b13ef5e06771e">&#9670;&nbsp;</a></span>init_Bfkmer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bloom_8h.html#a4bf3f34a321ce545e533d29ce363f569">Bfkmer</a>* init_Bfkmer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kmersize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hashNum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initializes a Bfkmer structure, given the kmersize and the number of hash functions </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kmersize</td><td>number of elements of the kmer </td></tr>
    <tr><td class="paramname">hashNum</td><td>number of hash functions to be computed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to a Bfkmer structure</dd></dl>
<p>kmersizeBytes, halfsizeBytes, hangingBases, hasOverhead hashNum are assigned and memory is allocated and set to 0 for compact and hashValues </p>

</div>
</div>
<a id="a0cc73db1215bac578f7d6e8df02d9768"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cc73db1215bac578f7d6e8df02d9768">&#9670;&nbsp;</a></span>init_LUTs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_LUTs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>look up table initialization </p>
<p>It initializes: fw0, fw1, fw2, fw3, bw0, bw2, bw3, bw4. They are uint8_t arrays with 256 elements. All elements are set to 0xFF excepting the ones corresponding to 'a', 'A', 'c', 'C', 'g', 'G', 't', 'T':</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Var  </th><th class="markdownTableHeadNone">a,A  </th><th class="markdownTableHeadNone">c,C  </th><th class="markdownTableHeadNone">g,G  </th><th class="markdownTableHeadNone">t,T  </th><th class="markdownTableHeadNone">Var  </th><th class="markdownTableHeadNone">a,A  </th><th class="markdownTableHeadNone">c,C  </th><th class="markdownTableHeadNone">g,G  </th><th class="markdownTableHeadNone">t,T   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">fw0  </td><td class="markdownTableBodyNone">0x00  </td><td class="markdownTableBodyNone">0x40  </td><td class="markdownTableBodyNone">0x80  </td><td class="markdownTableBodyNone">0xC0  </td><td class="markdownTableBodyNone">bw0  </td><td class="markdownTableBodyNone">0xC0  </td><td class="markdownTableBodyNone">0x80  </td><td class="markdownTableBodyNone">0x40  </td><td class="markdownTableBodyNone">0x00   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">fw1  </td><td class="markdownTableBodyNone">0x00  </td><td class="markdownTableBodyNone">0x10  </td><td class="markdownTableBodyNone">0x20  </td><td class="markdownTableBodyNone">0x30  </td><td class="markdownTableBodyNone">bw1  </td><td class="markdownTableBodyNone">0x30  </td><td class="markdownTableBodyNone">0x20  </td><td class="markdownTableBodyNone">0x10  </td><td class="markdownTableBodyNone">0x00   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">fw2  </td><td class="markdownTableBodyNone">0x00  </td><td class="markdownTableBodyNone">0x04  </td><td class="markdownTableBodyNone">0x08  </td><td class="markdownTableBodyNone">0x0C  </td><td class="markdownTableBodyNone">bw2  </td><td class="markdownTableBodyNone">0x0C  </td><td class="markdownTableBodyNone">0x08  </td><td class="markdownTableBodyNone">0x04  </td><td class="markdownTableBodyNone">0x00   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">fw3  </td><td class="markdownTableBodyNone">0x00  </td><td class="markdownTableBodyNone">0x01  </td><td class="markdownTableBodyNone">0x02  </td><td class="markdownTableBodyNone">0x03  </td><td class="markdownTableBodyNone">bw3  </td><td class="markdownTableBodyNone">0x03  </td><td class="markdownTableBodyNone">0x02  </td><td class="markdownTableBodyNone">0x01  </td><td class="markdownTableBodyNone">0x00   </td></tr>
</table>
<p>With these variables, we will be able to encode a Sequence using 2 bits per nucleotide. </p>

</div>
</div>
<a id="a80545f536f97a769a0c10cb437a83695"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80545f536f97a769a0c10cb437a83695">&#9670;&nbsp;</a></span>insert_and_fetch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="defines_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> insert_and_fetch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *&#160;</td>
          <td class="paramname"><em>ptr_bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bloom_8h.html#a4bf3f34a321ce545e533d29ce363f569">Bfkmer</a> *&#160;</td>
          <td class="paramname"><em>ptr_bfkmer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>inserts the hashvalues of a kmer in filter </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr_bf</td><td>pointer to Bfilter structure, where we will include the new entry </td></tr>
    <tr><td class="paramname">ptr_bfkmer</td><td>pointer to Bfkmer structure, where the hashvalues are stored </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the positions of the hash values were already set to one previously.</dd></dl>
<p>The hash values are inserted in the following way.</p><ul>
<li>modValue = hashvalue mod(filter size) is calculated.</li>
<li>the bit in position modValue of the filter is set to 1. </li>
</ul>

</div>
</div>
<a id="a4f4db9f997a1201561fea5f01df997a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f4db9f997a1201561fea5f01df997a8">&#9670;&nbsp;</a></span>multiHash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multiHash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bloom_8h.html#a4bf3f34a321ce545e533d29ce363f569">Bfkmer</a> *&#160;</td>
          <td class="paramname"><em>ptr_bfkmer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>obtains the hashNum hashvalues for a compactified kmer </p>
<p>The hash values are computed using the CityHash64 hash functions. </p>

</div>
</div>
<a id="af2418c40c2ff7a69a84aeb4ddde266e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2418c40c2ff7a69a84aeb4ddde266e0">&#9670;&nbsp;</a></span>read_Bfilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a>* read_Bfilter </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filterfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>paramfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>reads a bloom filter from a file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filterfile</td><td>path to file containing the filter </td></tr>
    <tr><td class="paramname">paramfile</td><td>path to file containing the filter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to a filter structure containing the bloomfilter</dd></dl>
<p>This function reads two files, the auxiliar inputfile where kmersize, hashNum and bfsizeBits are stored, and the actual filter file. If one of them is missing, the program exits with an error. If successful, a pointer to a Bfilter structure with the bloom filter is return </p>

</div>
</div>
<a id="a48a74d10082ed27381512e23650ba823"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48a74d10082ed27381512e23650ba823">&#9670;&nbsp;</a></span>save_Bfilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void save_Bfilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *&#160;</td>
          <td class="paramname"><em>ptr_bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filterfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>paramfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>saves a bloomfilter to disk </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr_bf</td><td>pointer to Bfilter structure (contains the filter) </td></tr>
    <tr><td class="paramname">filterfile</td><td>path to file where the output will be stored </td></tr>
    <tr><td class="paramname">paramfile</td><td>path to file where the prameters will be stored</td></tr>
  </table>
  </dd>
</dl>
<p>This function will save the bloomfilter in the path filterfile. The paramfile will store the following data:</p><ul>
<li>kmersize</li>
<li>hashNum</li>
<li>bfsizeBits</li>
<li>falsePosRate</li>
<li>nelem </li>
</ul>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a1f18264718e0b1b1be5a1f0ee64431e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f18264718e0b1b1be5a1f0ee64431e4">&#9670;&nbsp;</a></span>alloc_mem</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t alloc_mem</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>allocated memory</p>
<p>global variable. Memory allocated in the heap. </p>

</div>
</div>
<a id="ae59851bb0bb0e2d66b28d475a0eca5a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae59851bb0bb0e2d66b28d475a0eca5a0">&#9670;&nbsp;</a></span>bitMask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned char bitMask[0x08]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {0x01, 0x02, 0x04, 0x08,</div><div class="line">                                            0x10, 0x20, 0x40, 0x80}</div></div><!-- fragment -->
<p>bitMask, ith bit set to 1 in position i </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Mar 19 2018 23:42:01 for FastqPuri by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
