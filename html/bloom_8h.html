<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>FastqArazketa: include/bloom.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">FastqArazketa
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">bloom.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>functions that implement the bloom filter  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="city_8h_source.html">city.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fa__read_8h_source.html">fa_read.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="defines_8h_source.html">defines.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for bloom.h:</div>
<div class="dyncontent">
<div class="center"><img src="bloom_8h__incl.png" border="0" usemap="#include_2bloom_8h" alt=""/></div>
<map name="include_2bloom_8h" id="include_2bloom_8h">
<area shape="rect" id="node2" href="city_8h.html" title="functions for hashin strings, C translation of cityhash (C++, google) " alt="" coords="10,80,65,107"/><area shape="rect" id="node5" href="fa__read_8h.html" title="reads in and stores fasta files " alt="" coords="89,80,165,107"/><area shape="rect" id="node6" href="defines_8h.html" title="Macro definitions. " alt="" coords="189,80,264,107"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="bloom_8h__dep__incl.png" border="0" usemap="#include_2bloom_8hdep" alt=""/></div>
<map name="include_2bloom_8hdep" id="include_2bloom_8hdep">
<area shape="rect" id="node2" href="bloom_8c.html" title="functions that implement the bloom filter " alt="" coords="5,80,96,107"/><area shape="rect" id="node3" href="makeBloom_8c.html" title="makeBloom main function " alt="" coords="121,80,245,107"/></map>
</div>
</div>
<p><a href="bloom_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__bfilter.html">_bfilter</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bloom filter structure.  <a href="struct__bfilter.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__procs__kmer.html">_procs_kmer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">stores a processed kmer (2 bits pro nucleotide)  <a href="struct__procs__kmer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a6cb32cf059e8f4efd1ef80938d982836"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6cb32cf059e8f4efd1ef80938d982836"></a>
typedef struct <a class="el" href="struct__bfilter.html">_bfilter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a></td></tr>
<tr class="memdesc:a6cb32cf059e8f4efd1ef80938d982836"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bloom filter structure. <br /></td></tr>
<tr class="separator:a6cb32cf059e8f4efd1ef80938d982836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63b80bbec6bbee66eb6797f5312dde6e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a63b80bbec6bbee66eb6797f5312dde6e"></a>
typedef struct <a class="el" href="struct__procs__kmer.html">_procs_kmer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#a63b80bbec6bbee66eb6797f5312dde6e">Procs_kmer</a></td></tr>
<tr class="memdesc:a63b80bbec6bbee66eb6797f5312dde6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">stores a processed kmer (2 bits pro nucleotide) <br /></td></tr>
<tr class="separator:a63b80bbec6bbee66eb6797f5312dde6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0cc73db1215bac578f7d6e8df02d9768"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#a0cc73db1215bac578f7d6e8df02d9768">init_LUTs</a> ()</td></tr>
<tr class="memdesc:a0cc73db1215bac578f7d6e8df02d9768"><td class="mdescLeft">&#160;</td><td class="mdescRight">look up table initialization  <a href="#a0cc73db1215bac578f7d6e8df02d9768">More...</a><br /></td></tr>
<tr class="separator:a0cc73db1215bac578f7d6e8df02d9768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e5f24cae575f929614ff14daedab9ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#a5e5f24cae575f929614ff14daedab9ac">init_Bfilter</a> (int kmersize, uint64_t bfsizeBits, int hashNum, double falsePosRate, uint64_t nelem)</td></tr>
<tr class="memdesc:a5e5f24cae575f929614ff14daedab9ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialization of a Bfilter structure  <a href="#a5e5f24cae575f929614ff14daedab9ac">More...</a><br /></td></tr>
<tr class="separator:a5e5f24cae575f929614ff14daedab9ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cd02061aef113067b7cb701b399f502"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2cd02061aef113067b7cb701b399f502"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#a2cd02061aef113067b7cb701b399f502">free_Bfilter</a> (<a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *ptr_bf)</td></tr>
<tr class="memdesc:a2cd02061aef113067b7cb701b399f502"><td class="mdescLeft">&#160;</td><td class="mdescRight">free Bfilter memory <br /></td></tr>
<tr class="separator:a2cd02061aef113067b7cb701b399f502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad66c3b4f481734a97142bc82e9367e12"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bloom_8h.html#a63b80bbec6bbee66eb6797f5312dde6e">Procs_kmer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#ad66c3b4f481734a97142bc82e9367e12">init_procs</a> (int kmersize, int hashNum)</td></tr>
<tr class="memdesc:ad66c3b4f481734a97142bc82e9367e12"><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes a Procs structure, given the kmersize and the number of hash functions  <a href="#ad66c3b4f481734a97142bc82e9367e12">More...</a><br /></td></tr>
<tr class="separator:ad66c3b4f481734a97142bc82e9367e12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7efd5817adc624dcbc27953723c3438"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac7efd5817adc624dcbc27953723c3438"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#ac7efd5817adc624dcbc27953723c3438">free_procs</a> (<a class="el" href="bloom_8h.html#a63b80bbec6bbee66eb6797f5312dde6e">Procs_kmer</a> *procs)</td></tr>
<tr class="memdesc:ac7efd5817adc624dcbc27953723c3438"><td class="mdescLeft">&#160;</td><td class="mdescRight">free Procs_kmer <br /></td></tr>
<tr class="separator:ac7efd5817adc624dcbc27953723c3438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27438437e9301393d2671645c7ed52eb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#a27438437e9301393d2671645c7ed52eb">score_read_in_filter</a> (unsigned char *read, int L, <a class="el" href="bloom_8h.html#a63b80bbec6bbee66eb6797f5312dde6e">Procs_kmer</a> *procs, <a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *ptr_bf)</td></tr>
<tr class="memdesc:a27438437e9301393d2671645c7ed52eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes a score for a read being in the bloom filter  <a href="#a27438437e9301393d2671645c7ed52eb">More...</a><br /></td></tr>
<tr class="separator:a27438437e9301393d2671645c7ed52eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6e5788b92c0547d77425847d413851f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#ad6e5788b92c0547d77425847d413851f">create_Bfilter</a> (<a class="el" href="fa__read_8h.html#a797328b16bc1c1088998cd164aafb09d">Fa_data</a> *ptr_fasta, int kmersize, uint64_t bfsizeBits, int hashNum, double falsePosRate, uint64_t nelem)</td></tr>
<tr class="memdesc:ad6e5788b92c0547d77425847d413851f"><td class="mdescLeft">&#160;</td><td class="mdescRight">creates a bloom filter from a fasta structure.  <a href="#ad6e5788b92c0547d77425847d413851f">More...</a><br /></td></tr>
<tr class="separator:ad6e5788b92c0547d77425847d413851f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48a74d10082ed27381512e23650ba823"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#a48a74d10082ed27381512e23650ba823">save_Bfilter</a> (<a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *ptr_bf, char *filterfile, char *paramfile)</td></tr>
<tr class="memdesc:a48a74d10082ed27381512e23650ba823"><td class="mdescLeft">&#160;</td><td class="mdescRight">saves a bloomfilter to disk  <a href="#a48a74d10082ed27381512e23650ba823">More...</a><br /></td></tr>
<tr class="separator:a48a74d10082ed27381512e23650ba823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2418c40c2ff7a69a84aeb4ddde266e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#af2418c40c2ff7a69a84aeb4ddde266e0">read_Bfilter</a> (char *filterfile, char *paramfile)</td></tr>
<tr class="memdesc:af2418c40c2ff7a69a84aeb4ddde266e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">reads a bloom filter from a file  <a href="#af2418c40c2ff7a69a84aeb4ddde266e0">More...</a><br /></td></tr>
<tr class="separator:af2418c40c2ff7a69a84aeb4ddde266e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae59851bb0bb0e2d66b28d475a0eca5a0"><td class="memItemLeft" align="right" valign="top">static const unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bloom_8h.html#ae59851bb0bb0e2d66b28d475a0eca5a0">bitMask</a> [0x08]</td></tr>
<tr class="memdesc:ae59851bb0bb0e2d66b28d475a0eca5a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">bitMask, ith bit set to 1 in position i  <a href="#ae59851bb0bb0e2d66b28d475a0eca5a0">More...</a><br /></td></tr>
<tr class="separator:ae59851bb0bb0e2d66b28d475a0eca5a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>functions that implement the bloom filter </p>
<dl class="section author"><dt>Author</dt><dd>Paula Perez <a href="#" onclick="location.href='mai'+'lto:'+'pau'+'la'+'per'+'ez'+'rub'+'io'+'@gm'+'ai'+'l.c'+'om'; return false;">paula<span style="display: none;">.nosp@m.</span>pere<span style="display: none;">.nosp@m.</span>zrubi<span style="display: none;">.nosp@m.</span>o@gm<span style="display: none;">.nosp@m.</span>ail.c<span style="display: none;">.nosp@m.</span>om</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>04.09.2017 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad6e5788b92c0547d77425847d413851f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a>* create_Bfilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fa__read_8h.html#a797328b16bc1c1088998cd164aafb09d">Fa_data</a> *&#160;</td>
          <td class="paramname"><em>ptr_fasta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kmersize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>bfsizeBits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hashNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>falsePosRate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>nelem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>creates a bloom filter from a fasta structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr_fasta</td><td>pointer to fasta structure </td></tr>
    <tr><td class="paramname">kmersize</td><td>length of kmers to be inserted in the filter </td></tr>
    <tr><td class="paramname">bfsizeBits</td><td>size of Bloom filter in bits </td></tr>
    <tr><td class="paramname">hashNum</td><td>number of hash functions to be used </td></tr>
    <tr><td class="paramname">falsePosRate</td><td>false positive rate </td></tr>
    <tr><td class="paramname">nelem</td><td>number of elemens (kmers in the sequece) contained in the filter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to Bloom filter structure, where the fasta file was encoded. </dd></dl>

</div>
</div>
<a class="anchor" id="a5e5f24cae575f929614ff14daedab9ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a>* init_Bfilter </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kmersize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>bfsizeBits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hashNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>falsePosRate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>nelem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialization of a Bfilter structure </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kmersize</td><td>number of elements of the kmer </td></tr>
    <tr><td class="paramname">bfsizeBits</td><td>size of the bloomfilter (in Bits) </td></tr>
    <tr><td class="paramname">hashNum</td><td>number of hash functions to be computed </td></tr>
    <tr><td class="paramname">falsePosRate</td><td>false positive rate </td></tr>
    <tr><td class="paramname">nelem</td><td>number of elemens (kmers in the sequece) contained in the filter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to initialized Bfilter structure</dd></dl>
<p>Given a kmersize, bfsizeBits, number of hash functions, we assign these values to the struture and the two additional values: kmersizeBytes = (kmersize + BASESINCHAR - 1 )/BASESINCHAR </p>

</div>
</div>
<a class="anchor" id="a0cc73db1215bac578f7d6e8df02d9768"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_LUTs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>look up table initialization </p>
<p>It initializes: fw0, fw1, fw2, fw3, bw0, bw2, bw3, bw4. They are uint8_t arrays with 256 elements. All elements are set to 0xFF excepting the ones corresponding to 'a', 'A', 'c', 'C', 'g', 'G', 't', 'T':</p>
<table class="doxtable">
<tr>
<th>Var </th><th>a,A </th><th>c,C </th><th>g,G </th><th>t,T </th><th>Var </th><th>a,A </th><th>c,C </th><th>g,G </th><th>t,T  </th></tr>
<tr>
<td>fw0 </td><td>0x00 </td><td>0x40 </td><td>0x80 </td><td>0xC0 </td><td>bw0 </td><td>0xC0 </td><td>0x80 </td><td>0x40 </td><td>0x00 </td></tr>
<tr>
<td>fw1 </td><td>0x00 </td><td>0x10 </td><td>0x20 </td><td>0x30 </td><td>bw1 </td><td>0x30 </td><td>0x20 </td><td>0x10 </td><td>0x00 </td></tr>
<tr>
<td>fw2 </td><td>0x00 </td><td>0x04 </td><td>0x08 </td><td>0x0C </td><td>bw2 </td><td>0x0C </td><td>0x08 </td><td>0x04 </td><td>0x00 </td></tr>
<tr>
<td>fw3 </td><td>0x00 </td><td>0x01 </td><td>0x02 </td><td>0x03 </td><td>bw3 </td><td>0x03 </td><td>0x02 </td><td>0x01 </td><td>0x00 </td></tr>
</table>
<p>With these variables, we will be able to encode a Sequence using 2 bits per nucleotide. </p>

</div>
</div>
<a class="anchor" id="ad66c3b4f481734a97142bc82e9367e12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bloom_8h.html#a63b80bbec6bbee66eb6797f5312dde6e">Procs_kmer</a>* init_procs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kmersize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hashNum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initializes a Procs structure, given the kmersize and the number of hash functions </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kmersize</td><td>number of elements of the kmer </td></tr>
    <tr><td class="paramname">hashNum</td><td>number of hash functions to be computed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to a Procs_kmer structure</dd></dl>
<p>kmersizeBytes, halfsizeBytes, hangingBases, hasOverhead hashNum are assigned and memory is allocated and set to 0 for compact and hashValues </p>

</div>
</div>
<a class="anchor" id="af2418c40c2ff7a69a84aeb4ddde266e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a>* read_Bfilter </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filterfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>paramfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>reads a bloom filter from a file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inputfile</td><td>path to input file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to a filter structure containing the bloomfilter</dd></dl>
<p>This function reads two files, the auxiliar inputfile where kmersize, hashNum and bfsizeBits are stored, and the actual filter file. If one of them is missing, the program exits with an error. If successful, a pointer to a Bfilter structure with the bloom filter is return </p>

</div>
</div>
<a class="anchor" id="a48a74d10082ed27381512e23650ba823"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void save_Bfilter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *&#160;</td>
          <td class="paramname"><em>ptr_bf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filterfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>paramfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>saves a bloomfilter to disk </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr_bf</td><td>pointer to Bfilter structure (contains the filter) </td></tr>
    <tr><td class="paramname">filterfile</td><td>path to file where the output will be stored </td></tr>
    <tr><td class="paramname">paramfile</td><td>path to file where the prameters will be stored</td></tr>
  </table>
  </dd>
</dl>
<p>This function will save the bloomfilter in the path filterfile. The paramfile will store the following data:</p><ul>
<li>kmersize</li>
<li>hashNum</li>
<li>bfsizeBits</li>
<li>falsePosRate</li>
<li>nelem </li>
</ul>

</div>
</div>
<a class="anchor" id="a27438437e9301393d2671645c7ed52eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double score_read_in_filter </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bloom_8h.html#a63b80bbec6bbee66eb6797f5312dde6e">Procs_kmer</a> *&#160;</td>
          <td class="paramname"><em>procs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bloom_8h.html#a6cb32cf059e8f4efd1ef80938d982836">Bfilter</a> *&#160;</td>
          <td class="paramname"><em>ptr_bf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes a score for a read being in the bloom filter </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">read</td><td>sequence from fastq file </td></tr>
    <tr><td class="paramname">L</td><td>sequence length </td></tr>
    <tr><td class="paramname">procs</td><td>pointer to Procs structure </td></tr>
    <tr><td class="paramname">ptr_bf</td><td>pointer to Bfilter The score is computed by ... DECIDE!!! </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ae59851bb0bb0e2d66b28d475a0eca5a0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned char bitMask[0x08]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {0x01, 0x02, 0x04, 0x08,</div>
<div class="line">                                            0x10, 0x20, 0x40, 0x80}</div>
</div><!-- fragment -->
<p>bitMask, ith bit set to 1 in position i </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Sep 8 2017 11:45:53 for FastqArazketa by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
