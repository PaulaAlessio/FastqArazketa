\hypertarget{fa__read_8c}{\section{src/fa\+\_\+read.c File Reference}
\label{fa__read_8c}\index{src/fa\+\_\+read.\+c@{src/fa\+\_\+read.\+c}}
}


reads in and stores fasta files  


{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include \char`\"{}fa\+\_\+read.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}defines.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}fopen\+\_\+gen.\+h\char`\"{}}\\*
Include dependency graph for fa\+\_\+read.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{fa__read_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static int \hyperlink{fa__read_8c_ac5288f4a36dea040a40048bebb21ba34}{ignore\+\_\+line} (char $\ast$line)
\begin{DoxyCompactList}\small\item\em ignore header lines. \end{DoxyCompactList}\item 
static void \hyperlink{fa__read_8c_a5e790c4eb9bfc71776032610a65d88d7}{init\+\_\+fa} (\hyperlink{fa__read_8h_a797328b16bc1c1088998cd164aafb09d}{Fa\+\_\+data} $\ast$ptr\+\_\+fa)
\begin{DoxyCompactList}\small\item\em Initialization of Fa\+\_\+data. \end{DoxyCompactList}\item 
static void \hyperlink{fa__read_8c_a5c08d4c247d5c3e55bb572fb8d6a11bd}{realloc\+\_\+fa} (\hyperlink{fa__read_8h_a797328b16bc1c1088998cd164aafb09d}{Fa\+\_\+data} $\ast$ptr\+\_\+fa)
\begin{DoxyCompactList}\small\item\em Reallocation of Fa\+\_\+data, in case the length of entrylen is exhausted. \end{DoxyCompactList}\item 
static void \hyperlink{fa__read_8c_a58dddba8afcef6229172d7e5e11d6d77}{init\+\_\+entries} (\hyperlink{fa__read_8h_a797328b16bc1c1088998cd164aafb09d}{Fa\+\_\+data} $\ast$ptr\+\_\+fa)
\begin{DoxyCompactList}\small\item\em Allocation of Fa\+\_\+entries. \end{DoxyCompactList}\item 
static uint64\+\_\+t \hyperlink{fa__read_8c_aa1d4ac6800d8769ad1c917299579a81f}{sweep\+\_\+fa} (char $\ast$filename, \hyperlink{fa__read_8h_a797328b16bc1c1088998cd164aafb09d}{Fa\+\_\+data} $\ast$ptr\+\_\+fa)
\begin{DoxyCompactList}\small\item\em this function sweeps a fasta file to obtain structure details. \end{DoxyCompactList}\item 
int \hyperlink{fa__read_8c_a4d2d77d66924fdc762222c8f28f9718a}{read\+\_\+fasta} (char $\ast$filename, \hyperlink{fa__read_8h_a797328b16bc1c1088998cd164aafb09d}{Fa\+\_\+data} $\ast$ptr\+\_\+fa)
\begin{DoxyCompactList}\small\item\em reads a fasta file and stores the contents in a Fa\+\_\+data structure. \end{DoxyCompactList}\item 
void \hyperlink{fa__read_8c_a714b70ff332a85349cd52b76965dd444}{free\+\_\+fasta} (\hyperlink{fa__read_8h_a797328b16bc1c1088998cd164aafb09d}{Fa\+\_\+data} $\ast$ptr\+\_\+fa)
\begin{DoxyCompactList}\small\item\em free fasta file \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{fa__read_8c_a1f18264718e0b1b1be5a1f0ee64431e4}{uint64\+\_\+t {\bfseries alloc\+\_\+mem}}\label{fa__read_8c_a1f18264718e0b1b1be5a1f0ee64431e4}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
reads in and stores fasta files 

\begin{DoxyAuthor}{Author}
Paula Perez \href{mailto:paulaperezrubio@gmail.com}{\tt paulaperezrubio@gmail.\+com} 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
18.\+08.\+2017 
\end{DoxyDate}


\subsection{Function Documentation}
\hypertarget{fa__read_8c_a714b70ff332a85349cd52b76965dd444}{\index{fa\+\_\+read.\+c@{fa\+\_\+read.\+c}!free\+\_\+fasta@{free\+\_\+fasta}}
\index{free\+\_\+fasta@{free\+\_\+fasta}!fa\+\_\+read.\+c@{fa\+\_\+read.\+c}}
\subsubsection[{free\+\_\+fasta}]{\setlength{\rightskip}{0pt plus 5cm}void free\+\_\+fasta (
\begin{DoxyParamCaption}
\item[{{\bf Fa\+\_\+data} $\ast$}]{ptr\+\_\+fa}
\end{DoxyParamCaption}
)}}\label{fa__read_8c_a714b70ff332a85349cd52b76965dd444}


free fasta file 


\begin{DoxyParams}{Parameters}
{\em pointer} & to Fa\+\_\+data structure.\\
\hline
\end{DoxyParams}
The dynamically allocated memory in a Fa\+\_\+data struct is deallocated and counted, so that we can \hypertarget{fa__read_8c_ac5288f4a36dea040a40048bebb21ba34}{\index{fa\+\_\+read.\+c@{fa\+\_\+read.\+c}!ignore\+\_\+line@{ignore\+\_\+line}}
\index{ignore\+\_\+line@{ignore\+\_\+line}!fa\+\_\+read.\+c@{fa\+\_\+read.\+c}}
\subsubsection[{ignore\+\_\+line}]{\setlength{\rightskip}{0pt plus 5cm}static int ignore\+\_\+line (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{line}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fa__read_8c_ac5288f4a36dea040a40048bebb21ba34}


ignore header lines. 


\begin{DoxyParams}{Parameters}
{\em string} & of characters. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number of characters to jump until a ~\newline
 is found. 
\end{DoxyReturn}
\hypertarget{fa__read_8c_a58dddba8afcef6229172d7e5e11d6d77}{\index{fa\+\_\+read.\+c@{fa\+\_\+read.\+c}!init\+\_\+entries@{init\+\_\+entries}}
\index{init\+\_\+entries@{init\+\_\+entries}!fa\+\_\+read.\+c@{fa\+\_\+read.\+c}}
\subsubsection[{init\+\_\+entries}]{\setlength{\rightskip}{0pt plus 5cm}static void init\+\_\+entries (
\begin{DoxyParamCaption}
\item[{{\bf Fa\+\_\+data} $\ast$}]{ptr\+\_\+fa}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fa__read_8c_a58dddba8afcef6229172d7e5e11d6d77}


Allocation of Fa\+\_\+entries. 


\begin{DoxyParams}{Parameters}
{\em pointer} & to Fa\+\_\+data structure.\\
\hline
\end{DoxyParams}
When we have sweeped the fasta file once, we can proceed to allocate the memory for the entries (now we have registered their length). \hypertarget{fa__read_8c_a5e790c4eb9bfc71776032610a65d88d7}{\index{fa\+\_\+read.\+c@{fa\+\_\+read.\+c}!init\+\_\+fa@{init\+\_\+fa}}
\index{init\+\_\+fa@{init\+\_\+fa}!fa\+\_\+read.\+c@{fa\+\_\+read.\+c}}
\subsubsection[{init\+\_\+fa}]{\setlength{\rightskip}{0pt plus 5cm}static void init\+\_\+fa (
\begin{DoxyParamCaption}
\item[{{\bf Fa\+\_\+data} $\ast$}]{ptr\+\_\+fa}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fa__read_8c_a5e790c4eb9bfc71776032610a65d88d7}


Initialization of Fa\+\_\+data. 


\begin{DoxyParams}{Parameters}
{\em pointer} & to Fa\+\_\+data structure.\\
\hline
\end{DoxyParams}
Initializes nlines, linelen, nentries to 0 and allocates memory for entrylen (F\+A\+\_\+\+E\+N\+T\+R\+Y\+\_\+\+B\+U\+F entries). \hypertarget{fa__read_8c_a4d2d77d66924fdc762222c8f28f9718a}{\index{fa\+\_\+read.\+c@{fa\+\_\+read.\+c}!read\+\_\+fasta@{read\+\_\+fasta}}
\index{read\+\_\+fasta@{read\+\_\+fasta}!fa\+\_\+read.\+c@{fa\+\_\+read.\+c}}
\subsubsection[{read\+\_\+fasta}]{\setlength{\rightskip}{0pt plus 5cm}int read\+\_\+fasta (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{filename, }
\item[{{\bf Fa\+\_\+data} $\ast$}]{ptr\+\_\+fa}
\end{DoxyParamCaption}
)}}\label{fa__read_8c_a4d2d77d66924fdc762222c8f28f9718a}


reads a fasta file and stores the contents in a Fa\+\_\+data structure. 


\begin{DoxyParams}{Parameters}
{\em path} & to a fasta input file. \\
\hline
{\em pointer} & to Fa\+\_\+data structure. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number of entries in the fasta file.
\end{DoxyReturn}
A fasta file is read and stored in a structure Fa\+\_\+data The basic problem with reading F\+A\+S\+T\+A files is that there is no end-\/of-\/record indicator. When you're reading sequence n, you don't know you're done until you've read the header line for sequence n+1, which you won't parse 'til later (when you're reading in the sequence n+1). The solution implemented here is to read the file twice. The first time, (sweep\+\_\+fa), we initialize Fa\+\_\+data and store the parameters\+:
\begin{DoxyItemize}
\item nlines\+: number of lines of the fasta file.
\item nentries\+: number of entries in the fasta file.
\item linelen\+: length of a line in the considered fasta file.
\item entrylen\+: array containing the lengths of every entry. With this information, the pointer to Fa\+\_\+entry can be allocated and the file is read again and the entries are stored in the structure. 
\end{DoxyItemize}\hypertarget{fa__read_8c_a5c08d4c247d5c3e55bb572fb8d6a11bd}{\index{fa\+\_\+read.\+c@{fa\+\_\+read.\+c}!realloc\+\_\+fa@{realloc\+\_\+fa}}
\index{realloc\+\_\+fa@{realloc\+\_\+fa}!fa\+\_\+read.\+c@{fa\+\_\+read.\+c}}
\subsubsection[{realloc\+\_\+fa}]{\setlength{\rightskip}{0pt plus 5cm}static void realloc\+\_\+fa (
\begin{DoxyParamCaption}
\item[{{\bf Fa\+\_\+data} $\ast$}]{ptr\+\_\+fa}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fa__read_8c_a5c08d4c247d5c3e55bb572fb8d6a11bd}


Reallocation of Fa\+\_\+data, in case the length of entrylen is exhausted. 


\begin{DoxyParams}{Parameters}
{\em pointer} & to Fa\+\_\+data. \\
\hline
\end{DoxyParams}
\hypertarget{fa__read_8c_aa1d4ac6800d8769ad1c917299579a81f}{\index{fa\+\_\+read.\+c@{fa\+\_\+read.\+c}!sweep\+\_\+fa@{sweep\+\_\+fa}}
\index{sweep\+\_\+fa@{sweep\+\_\+fa}!fa\+\_\+read.\+c@{fa\+\_\+read.\+c}}
\subsubsection[{sweep\+\_\+fa}]{\setlength{\rightskip}{0pt plus 5cm}static uint64\+\_\+t sweep\+\_\+fa (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{filename, }
\item[{{\bf Fa\+\_\+data} $\ast$}]{ptr\+\_\+fa}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{fa__read_8c_aa1d4ac6800d8769ad1c917299579a81f}


this function sweeps a fasta file to obtain structure details. 


\begin{DoxyParams}{Parameters}
{\em path} & to a fasta input file. \\
\hline
{\em pointer} & to Fa\+\_\+data structure. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
size of fasta file.
\end{DoxyReturn}
This function sweeps over the fasta file once to annotate how many entries there are, how long they are, how many characters there are per line, and how many lines the file has. 